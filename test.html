<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chrono Pass V3: Real Inventory</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; }
        .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
        .gradient-bg { background: linear-gradient(135deg, #0f172a 0%, #334155 100%); }
        .item-row:nth-child(even) { background-color: #f8fafc; }
        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #e2e8f0; }
        ::-webkit-scrollbar-thumb { background: #64748b; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }
    </style>
</head>
<body class="gradient-bg min-h-screen text-gray-800 p-2 md:p-6">

    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <header class="text-center mb-6 text-white">
            <h1 class="text-2xl md:text-4xl font-bold">üéí Chrono Pass Calculator: Full Inventory</h1>
            <p class="text-gray-400 text-sm md:text-base mt-1">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡∏±‡∏ô‡∏à‡∏ö ‚Ä¢ ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ‚Ä¢ ‡πÅ‡∏•‡∏∞‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏ï‡∏±‡∏ß‡∏ó‡∏∏‡∏Å‡∏ä‡∏¥‡πâ‡∏ô</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-4">
            
            <!-- LEFT: Controls (4 Cols) -->
            <div class="lg:col-span-4 space-y-4">
                <div class="glass rounded-xl p-5 shadow-lg border border-gray-200">
                    <h2 class="font-bold text-lg text-blue-900 border-b pb-2 mb-4">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</h2>
                    
                    <!-- Date -->
                    <div class="mb-3">
                        <label class="block text-xs font-bold text-gray-500 uppercase">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                        <input type="date" id="currentDate" class="w-full mt-1 border border-gray-300 rounded p-2 focus:ring-2 focus:ring-blue-500">
                    </div>

                    <!-- Target Level -->
                    <div class="mb-3">
                        <label class="block text-xs font-bold text-gray-500 uppercase">‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</label>
                        <div class="flex space-x-2 mt-1">
                            <input type="number" id="targetLevel" value="2500" class="w-2/3 border border-gray-300 rounded p-2 font-bold text-blue-700 text-lg text-center">
                            <button onclick="setTarget(2500)" class="w-1/3 bg-yellow-100 hover:bg-yellow-200 text-yellow-800 font-bold rounded text-xs border border-yellow-300">Max (2500)</button>
                        </div>
                        <div class="flex justify-between mt-2 gap-2">
                            <button onclick="setTarget(1)" class="flex-1 bg-gray-100 hover:bg-gray-200 py-1 rounded text-xs text-gray-600">Lv.1</button>
                            <button onclick="setTarget(100)" class="flex-1 bg-gray-100 hover:bg-gray-200 py-1 rounded text-xs text-gray-600">Lv.100</button>
                            <button onclick="setTarget(300)" class="flex-1 bg-gray-100 hover:bg-gray-200 py-1 rounded text-xs text-gray-600">Lv.300</button>
                        </div>
                    </div>

                    <!-- Quests -->
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200 mb-3">
                        <p class="text-xs font-bold text-gray-500 mb-2">‡πÄ‡∏Ñ‡∏ß‡∏™‡∏ó‡∏µ‡πà‡∏ó‡∏≥ (Grinding)</p>
                        <div class="space-y-2">
                            <label class="flex items-center space-x-2"><input type="checkbox" id="qDaily" checked class="text-blue-600"> <span class="text-sm">Daily Quest (30 XP)</span></label>
                            <label class="flex items-center space-x-2"><input type="checkbox" id="qZenyD" checked class="text-green-600"> <span class="text-sm">Daily Zeny (30 XP)</span></label>
                            <label class="flex items-center space-x-2"><input type="checkbox" id="qWeekly" checked class="text-blue-600"> <span class="text-sm">Weekly Quest (300 XP)</span></label>
                            <label class="flex items-center space-x-2"><input type="checkbox" id="qZenyW" class="text-red-500"> <span class="text-sm text-red-500">Weekly Zeny (40 XP)</span></label>
                        </div>
                    </div>

                    <!-- Promo -->
                    <div class="bg-yellow-50 p-3 rounded-lg border border-yellow-200">
                        <label class="flex items-center space-x-2 cursor-pointer">
                            <input type="checkbox" id="usePromo" checked class="text-yellow-600 w-5 h-5">
                            <span class="text-sm font-bold text-yellow-800">‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô Medal (18-25 ‡∏Å.‡∏û.)</span>
                        </label>
                    </div>

                    <button onclick="calculate()" class="w-full mt-4 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg shadow-lg transition active:scale-95">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà</button>
                </div>
                
                <!-- Summary Card -->
                <div class="glass rounded-xl p-5 shadow-lg border-l-4 border-purple-500">
                    <h3 class="text-sm font-bold text-gray-500 uppercase">‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</h3>
                    <div class="mt-2 flex justify-between items-baseline">
                        <span class="text-3xl font-bold text-purple-700" id="dispSV">0</span>
                        <span class="text-sm font-bold text-purple-500">Silvervine</span>
                    </div>
                    <div class="flex justify-between items-baseline mt-1">
                        <span class="text-lg font-bold text-gray-600" id="dispZeny">0</span>
                        <span class="text-xs text-gray-400">MB (Zeny)</span>
                    </div>
                    <div class="mt-3 pt-3 border-t border-gray-200">
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏≠‡∏á (Grind):</span>
                            <span class="font-bold text-green-600" id="dispGrind">0 Lv</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏° (Buy):</span>
                            <span class="font-bold text-blue-600" id="dispBuy">0 Lv</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RIGHT: Inventory List (8 Cols) -->
            <div class="lg:col-span-8">
                <div class="glass rounded-xl shadow-xl overflow-hidden flex flex-col h-full max-h-[800px]">
                    <div class="p-4 bg-gray-100 border-b border-gray-200 flex justify-between items-center">
                        <h2 class="font-bold text-lg text-gray-800 flex items-center">
                            <span class="text-2xl mr-2">üéí</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏≠‡πÄ‡∏ó‡∏°‡∏™‡∏∞‡∏™‡∏° (Cumulative Inventory)
                        </h2>
                        <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full font-bold" id="levelBadge">Lv. 0 Rewards</span>
                    </div>

                    <!-- Scrollable Area -->
                    <div class="flex-1 overflow-y-auto p-4 custom-scrollbar">
                        
                        <!-- 1. Highlight Rares -->
                        <div class="mb-6">
                            <h3 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2">üåü ‡∏Ç‡∏≠‡∏á‡πÅ‡∏£‡∏£‡πå & ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (Highlights)</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3" id="rareContainer">
                                <!-- JS Injected -->
                            </div>
                        </div>

                        <!-- 2. Consumables Table -->
                        <div>
                            <h3 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2">üì¶ ‡πÑ‡∏≠‡πÄ‡∏ó‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô & ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏™‡∏∏‡πà‡∏° (Consumables)</h3>
                            <div class="bg-white rounded-lg border border-gray-200 overflow-hidden">
                                <table class="w-full text-sm text-left">
                                    <thead class="bg-gray-50 text-gray-500 font-bold border-b border-gray-200">
                                        <tr>
                                            <th class="p-3">‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏≠‡πÄ‡∏ó‡∏°</th>
                                            <th class="p-3 text-right">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏ß‡∏°</th>
                                            <th class="p-3 text-center w-24">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                                        </tr>
                                    </thead>
                                    <tbody id="consuBody" class="divide-y divide-gray-100">
                                        <!-- JS Injected -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>
                    
                    <!-- Footer Info -->
                    <div class="p-3 bg-yellow-50 text-xs text-yellow-800 text-center border-t border-yellow-100">
                        *‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏≠‡πÄ‡∏ó‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏∞‡∏™‡∏°‡∏à‡∏≤‡∏Å Lv.1 ‡∏ñ‡∏∂‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ (‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• Level 1 Premium Starter)
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- Data & Constants ---
        const EVENT_START = new Date('2026-02-18');
        const EVENT_END = new Date('2026-03-25');
        const PROMO_END = new Date('2026-02-25');

        // Database of Rewards (Simulated Pattern + Specifics)
        const REWARD_DB = {
            // Level 1 Starter Pack (Premium) - ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤ "‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏°‡∏≤‡∏¢"
            1: [
                { name: "[Not For Sale] Battle Manual", qty: 5, type: "EXP" },
                { name: "[Not For Sale] Job Manual", qty: 5, type: "EXP" },
                { name: "[Not For Sale] Bubble Gum", qty: 5, type: "Drop" },
                { name: "[Not For Sale] Life Insurance", qty: 10, type: "Protect" },
                { name: "[Not For Sale] Token of Siegfried", qty: 10, type: "Revive" },
                { name: "World Teleport Scroll", qty: 20, type: "Utility" },
                { name: "Kafra Card", qty: 20, type: "Utility" },
                { name: "[Not For Sale] Small Life Potion", qty: 10, type: "Potion" },
                { name: "[Not For Sale] Small Mana Potion", qty: 10, type: "Potion" }
            ],
            // Milestones
            100: [{ name: "[Not For Sale] Chrono Pass Ticket", qty: 1, type: "Rare", icon: "üé´" }],
            200: [{ name: "Costume Cosmic Connection", qty: 1, type: "Costume", icon: "üé≠" }],
            300: [{ name: "[Not For Sale] Chrono Pass Ticket", qty: 1, type: "Rare", icon: "üé´" }],
            350: [
                { name: "Guarantee Weapon +7 Pack", qty: 1, type: "Refine", icon: "‚öîÔ∏è" },
                { name: "Special Enchant Temporal Boots", qty: 1, type: "Item", icon: "üë¢" }
            ],
            400: [{ name: "Guarantee Armor +7 Pack", qty: 1, type: "Refine", icon: "üõ°Ô∏è" }],
            600: [{ name: "Guarantee Weapon +9 Pack", qty: 1, type: "Refine", icon: "‚öîÔ∏è" }],
            700: [{ name: "Guarantee Armor +9 Pack", qty: 1, type: "Refine", icon: "üõ°Ô∏è" }],
            1500: [{ name: "Guarantee Weapon +11 Pack", qty: 1, type: "Refine", icon: "üî•" }],
            2000: [{ name: "Guarantee Armor +11 Pack", qty: 1, type: "Refine", icon: "üî•" }],
            2500: [{ name: "Costume Golden Valkyrie Wings", qty: 1, type: "Grand", icon: "üëë" }]
        };

        // Recurring Rewards Pattern (Generic Consumables)
        // ‡∏ó‡∏∏‡∏Å‡πÜ X ‡πÄ‡∏•‡πÄ‡∏ß‡∏• ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡∏û‡∏ß‡∏Å‡∏ô‡∏µ‡πâ (‡∏™‡∏°‡∏°‡∏ï‡∏¥ Pattern ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏à‡∏£‡∏¥‡∏á)
        const PATTERNS = [
            { interval: 5, items: [{ name: "[Not For Sale] Small Life Potion", qty: 2 }, { name: "[Not For Sale] Small Mana Potion", qty: 1 }] },
            { interval: 10, items: [{ name: "Treasure Box I", qty: 1 }, { name: "Thai Perfume (EXP)", qty: 1 }] },
            { interval: 20, items: [{ name: "Treasure Box II", qty: 1 }, { name: "[Not For Sale] Ultimate Cook", qty: 2 }] },
            { interval: 50, items: [{ name: "Treasure Box III", qty: 1 }, { name: "[Not For Sale] Abrasive", qty: 1 }] }
        ];

        document.getElementById('currentDate').valueAsDate = new Date();

        function setTarget(val) {
            document.getElementById('targetLevel').value = val;
            calculate();
        }

        function calculate() {
            // Inputs
            const dStr = document.getElementById('currentDate').value;
            const targetLv = parseInt(document.getElementById('targetLevel').value) || 1;
            const usePromo = document.getElementById('usePromo').checked;

            // Date Check
            const now = new Date(dStr);
            let promoActive = usePromo;
            if (usePromo && now > PROMO_END) promoActive = false;

            // Time & Grind Calc (Simplified for V3 focus on Inventory)
            const diffTime = Math.max(0, EVENT_END - now);
            const daysLeft = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
            const weeksLeft = Math.ceil(daysLeft / 7);

            let dailyExp = 0;
            if(document.getElementById('qDaily').checked) dailyExp += 30;
            if(document.getElementById('qZenyD').checked) dailyExp += 30;
            
            let weeklyExp = 0;
            if(document.getElementById('qWeekly').checked) weeklyExp += 300;
            if(document.getElementById('qZenyW').checked) weeklyExp += 40;

            const totalGrindExp = (dailyExp * daysLeft) + (weeklyExp * weeksLeft);
            let grindLv = Math.floor(totalGrindExp / 10); // 10 EXP = 1 Lv
            
            // Logic: You get rewards up to Target Level.
            // If Target > Grind, you buy the rest.
            let buyLv = targetLv - grindLv;
            if (buyLv < 0) {
                buyLv = 0; 
                // grindLv = targetLv; // No, showing actual max grind is better context
            }
            
            // Buying Cost
            let costSV = 0;
            let medals = 0;
            let rem = buyLv;
            
            // Buying Logic
            if(rem > 0) {
                let p3000 = Math.floor(rem/1000); costSV += p3000*3000; if(promoActive) medals += p3000*6000; rem%=1000;
                let p300 = Math.floor(rem/100); costSV += p300*300; if(promoActive) medals += p300*500; rem%=100;
                let p30 = Math.floor(rem/10); costSV += p30*30; rem%=10;
                costSV += rem*3;
            }

            // Zeny Cost
            let costZeny = (document.getElementById('qZenyD').checked ? 1000000 * daysLeft : 0) + 
                           (document.getElementById('qZenyW').checked ? 10000000 * weeksLeft : 0);

            // Update Left Panel
            document.getElementById('dispSV').innerText = costSV.toLocaleString();
            document.getElementById('dispZeny').innerText = (costZeny/1000000).toFixed(1);
            document.getElementById('dispGrind').innerText = Math.min(grindLv, targetLv).toLocaleString();
            document.getElementById('dispBuy').innerText = buyLv.toLocaleString();
            document.getElementById('levelBadge').innerText = `‡∏™‡∏∞‡∏™‡∏°‡∏ñ‡∏∂‡∏á Lv. ${targetLv}`;

            // --- INVENTORY GENERATION ---
            generateFullInventory(targetLv, medals);
        }

        function generateFullInventory(level, medals) {
            let inventory = {};
            let rares = [];

            // 1. Process Fixed Rewards (Database)
            for (let lv = 1; lv <= level; lv++) {
                if (REWARD_DB[lv]) {
                    REWARD_DB[lv].forEach(item => {
                        if (['Rare','Costume','Refine','Item','Grand'].includes(item.type)) {
                            rares.push({ ...item, level: lv });
                        } else {
                            addItem(inventory, item.name, item.qty, item.type);
                        }
                    });
                }
            }

            // 2. Process Patterns (Recurring Items)
            // Start form Lv 2 because Lv 1 is fixed starter pack
            for (let lv = 2; lv <= level; lv++) {
                PATTERNS.forEach(pat => {
                    if (lv % pat.interval === 0) {
                        pat.items.forEach(itm => addItem(inventory, itm.name, itm.qty, "Consumable"));
                    }
                });
            }

            // 3. Add Medals if any
            if (medals > 0) {
                rares.unshift({ name: "Mysterious Medal", qty: medals, type: "Currency", icon: "üèÖ", special: true });
            }

            // --- RENDER ---
            
            // Render Rares
            const rareDiv = document.getElementById('rareContainer');
            rareDiv.innerHTML = "";
            rares.forEach(r => {
                const isGrand = r.type === 'Grand';
                const html = `
                    <div class="flex items-center p-3 rounded-lg border ${isGrand ? 'bg-yellow-50 border-yellow-300 ring-1 ring-yellow-200' : 'bg-white border-blue-100'} shadow-sm item-card">
                        <div class="text-2xl mr-3">${r.icon || 'üíé'}</div>
                        <div class="flex-1">
                            <div class="text-sm font-bold text-gray-800">${r.name}</div>
                            <div class="text-xs text-gray-500">${r.special ? '‡∏à‡∏≤‡∏Å‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô' : '‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà Lv.' + r.level}</div>
                        </div>
                        <div class="font-bold text-blue-600 bg-blue-50 px-2 rounded">x${r.qty.toLocaleString()}</div>
                    </div>
                `;
                rareDiv.innerHTML += html;
            });

            // Render Consumables
            const consuBody = document.getElementById('consuBody');
            consuBody.innerHTML = "";
            
            // Sort inventory by qty desc
            const sortedItems = Object.entries(inventory).sort((a,b) => b[1].qty - a[1].qty);

            sortedItems.forEach(([name, data]) => {
                const html = `
                    <tr class="item-row border-b border-gray-100 hover:bg-blue-50 transition">
                        <td class="p-3 font-medium text-gray-700">${name}</td>
                        <td class="p-3 text-right font-bold text-blue-600">x${data.qty.toLocaleString()}</td>
                        <td class="p-3 text-center text-xs">
                            <span class="px-2 py-1 rounded-full bg-gray-100 text-gray-500">${data.type}</span>
                        </td>
                    </tr>
                `;
                consuBody.innerHTML += html;
            });
        }

        function addItem(inv, name, qty, type) {
            if (!inv[name]) inv[name] = { qty: 0, type: type };
            inv[name].qty += qty;
        }

        // Init
        calculate();
    </script>
</body>
</html>


